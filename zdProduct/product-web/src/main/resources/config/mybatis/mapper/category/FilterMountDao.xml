<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="FilterMountDaoImpl">

 	<resultMap type="com.zhaidou.product.category.model.FilterMountPO" id="FilterMountPO_query_list">
        <result property="id" column="relation_id"/>
        <result property="categoryId" column="category_id"/>
        <result property="categoryCode" column="category_code"/>
        <result property="attrId" column="attr_id"/>
        <result property="attrCode" column="attr_code"/>
        <result property="attrValId" column="attr_value_id"/>
        <result property="attrValCode" column="attr_value_code"/>
        <result property="orderNumber" column="order_number"/>
        <result property="deleteFlag" column="delete_flag"/>
        <result property="createDate" column="create_time"/>
        <result property="createUser" column="create_user"/>
        <result property="updateUser" column="last_update_user"/>
        <result property="updateDate" column="last_update_time"/>
    </resultMap>

	<insert id="insert" parameterType="com.zhaidou.product.category.model.FilterMountPO"  useGeneratedKeys="true" keyProperty="id">
		insert into t_salecategory_filter_relation
		(
		    category_id,
		    category_code,
		    attr_id,
   			attr_code,
   			attr_value_id,
   			attr_value_code,
   			order_number,
		    delete_flag,
		    create_time,
		    create_user,
		    last_update_time,
		    last_update_user
		) 
	   values 
	   (
	      #{categoryId},
	      #{categoryCode},
	      #{attrId},
	      #{attrCode},
	      #{attrValId},
	      #{attrValCode},
	      #{orderNumber},
	      #{deleteFlag},
	      #{createDate},
	      #{createUser},
	      #{createDate},
	      #{createUser}
	  )
	</insert>
	 
	<update id="update" parameterType="com.zhaidou.product.category.model.FilterMountPO" >
	   UPDATE t_salecategory_filter_relation
	      SET 
	         <if test="orderNumber != null ">
	              order_number = #{orderNumber},
	         </if>
	         <if test="deleteFlag != null ">
		          delete_flag = #{deleteFlag},
	         </if>
	          last_update_time = now(),
		      last_update_user = #{updateUser}
	    WHERE relation_id = #{id}
	</update>
	
	<update id="delete" parameterType="com.zhaidou.product.category.model.FilterMountPO" >
	   UPDATE t_salecategory_filter_relation
	      SET delete_flag = 1,
	          last_update_time = now(),
		      last_update_user = #{updateUser}
	    WHERE relation_id = #{id}
	</update>
		   
	<update id="deleteByCategoryId" parameterType="com.zhaidou.product.category.model.FilterMountPO" >
	   UPDATE t_salecategory_filter_relation
	      SET delete_flag = 1,
	          last_update_time = now(),
		      last_update_user = #{updateUser}
	    WHERE category_id = #{categoryId}
	</update> 
	
	<update id="deleteByCateCodeAndAttrCode" parameterType="com.zhaidou.product.category.model.FilterMountPO" >
	   UPDATE t_salecategory_filter_relation
	      SET delete_flag = 1,
	          last_update_time = now(),
		      last_update_user = #{updateUser}
	    WHERE category_code = #{categoryCode} and attr_code = #{attrCode}
	</update>   
	
	
	<update id="updateOrderByCateCodeAndAttrCode" parameterType="com.zhaidou.product.category.model.FilterMountPO" >
	   UPDATE t_salecategory_filter_relation
	      SET  order_number = #{orderNumber},
	          last_update_time = now(),
		      last_update_user = #{updateUser}
	    WHERE category_code = #{categoryCode} and attr_code = #{attrCode}
	</update> 
	
	
    <select id="queryListByCategoryId" parameterType="com.zhaidou.product.category.model.FilterMountPO" resultMap="FilterMountPO_query_list">
       SELECT
            relation_id,
            category_id,
		    category_code,
		    attr_id,
   			attr_code,
   			attr_value_id,
   			attr_value_code,
   			order_number,
		    delete_flag,
		    create_time,
		    create_user,
		    last_update_time,
		    last_update_user
	   FROM t_salecategory_filter_relation 
	   WHERE category_id = #{categoryId} and delete_flag=0 
    </select>
    
</mapper>